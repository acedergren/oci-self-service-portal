---
phase: 10-foundation-rewrite
plan: 07
type: execute
wave: 4
depends_on:
  - 10-03
  - 10-04
  - 10-05
  - 10-06
files_modified:
  - packages/types/package.json
  - packages/types/tsconfig.json
  - packages/types/src/index.ts
  - packages/types/src/api/types.ts
  - packages/types/src/errors.ts
  - packages/types/src/workflows/types.ts
  - packages/shared/src/api/types.ts
  - packages/shared/src/errors.ts
  - packages/shared/src/workflows/types.ts
  - tsconfig.base.json
  - package.json
autonomous: true
must_haves:
  truths:
    - "@portal/types exists as a standalone package with zero runtime dependencies beyond Zod."
    - "All consumers import types from @portal/types rather than @portal/shared."
    - "TypeScript compilation succeeds with the new package boundaries."
  artifacts:
    - path: "packages/types/package.json"
      provides: "Independent types package manifest"
    - path: "packages/types/src/index.ts"
      provides: "Central exports for all shared types"
    - path: "tsconfig.base.json"
      provides: "Path mappings updated for new package"
  key_links:
    - from: "packages/types/src/index.ts"
      to: "packages/types/src/api/types.ts"
      via: "export * from"
      pattern: "export \* from './api/types'"
    - from: "package.json"
      to: "packages/types"
      via: "workspaces"
      pattern: "packages\/types"
---

<objective>
Split the shared types into a dedicated `@portal/types` workspace package with zero runtime dependencies, updating imports project-wide.

Purpose: Deliver the package separation foundation required for later server/UI splits per PRD.
Output: New types package, updated imports, and passing TypeScript builds.
</objective>

<execution_context>
@/Users/acedergr/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/acedergr/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.claude/reference/PRD.md
@packages/shared/src/index.ts
</context>

<tasks>

<task type="auto">
  <name>Scaffold @portal/types package and move source files</name>
  <files>packages/types/package.json</files>
  <action>
  - Create `packages/types` with `package.json`, `tsconfig.json`, and `src/index.ts`, declaring only `zod` as runtime dependency.
  - Move type-focused modules from `packages/shared` (errors, API types, workflows, tools schemas) into the new package, preserving relative imports.
  - Update barrel exports to centralize under `packages/types/src/index.ts`.
  </action>
  <verify>pnpm --filter @portal/types build</verify>
  <done>`@portal/types` package exists with moved source files and builds successfully.</done>
</task>

<task type="auto">
  <name>Update repository import paths</name>
  <files>tsconfig.base.json</files>
  <action>
  - Adjust root `tsconfig` path aliases and workspace `package.json` to include `@portal/types`.
  - Replace imports of `@portal/shared/*` types across apps and packages with `@portal/types/*`.
  - Ensure Jest/Vitest aliases (if any) are updated to resolve the new package path.
  </action>
  <verify>
    pnpm lint
    pnpm --filter @portal/api test
    pnpm --filter @portal/frontend test
  </verify>
  <done>All code references `@portal/types` for shared types with lint/tests passing.</done>
</task>

<task type="auto">
  <name>Remove duplicate type exports from @portal/shared</name>
  <files>packages/shared/src/api/types.ts</files>
  <action>
  - Delete or convert the previous type modules within `@portal/shared` to re-export from `@portal/types` where necessary.
  - Ensure `packages/shared/src/index.ts` no longer re-exports types that have moved.
  - Update build scripts to exclude removed files, confirming `pnpm --filter @portal/shared build` succeeds.
  </action>
  <verify>pnpm --filter @portal/shared build</verify>
  <done>`@portal/shared` no longer includes moved type modules and builds cleanly.</done>
</task>

</tasks>

<verification>
- `pnpm --filter @portal/types build`
- `pnpm lint`
- `pnpm --filter @portal/api test`
- `pnpm --filter @portal/frontend test`
- `pnpm --filter @portal/shared build`
</verification>

<success_criteria>

- `@portal/types` hosts shared schemas with zero runtime deps and all projects compile.
- `@portal/shared` no longer contains type-only modules.
  </success_criteria>

<output>
After completion, create `.planning/phases/10-foundation-rewrite/10-07-SUMMARY.md`
</output>
