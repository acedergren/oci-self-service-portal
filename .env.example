# =============================================================================
# CloudNow - Environment Configuration
# =============================================================================
# Copy this file to .env and fill in the values.
#
#   cp .env.example .env
#
# Variables with defaults in docker-compose.yml are listed here for reference.
# Override them in .env only if you need non-default values.
# =============================================================================

# -----------------------------------------------------------------------------
# Application
# -----------------------------------------------------------------------------
# NODE_ENV=production          # Set in docker-compose.yml
# PORT=3001                    # Use 3001 locally: SvelteKit SSR defaults FASTIFY_URL to
#                              # http://localhost:3001 (see apps/frontend/src/routes/+layout.server.ts)
# HOST=0.0.0.0                 # Set in docker-compose.yml
# LOG_LEVEL=info               # Set in docker-compose.yml (options: debug, info, warn, error)

# -----------------------------------------------------------------------------
# OCI Configuration
# -----------------------------------------------------------------------------
OCI_COMPARTMENT_ID=ocid1.compartment.oc1..aaaaaaaxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
# OCI_REGION=eu-frankfurt-1    # Set in docker-compose.yml
# OCI_AUTH_METHOD=config_file  # Set in docker-compose.yml (options: config_file, instance_principal, resource_principal)
OCI_CONFIG_PROFILE=DEFAULT

# -----------------------------------------------------------------------------
# OCI GenAI Model Configuration
# -----------------------------------------------------------------------------
# OCI_GENAI_MODEL_ID=cohere.command-r-plus
# OCI_GENAI_ENDPOINT=https://inference.generativeai.eu-frankfurt-1.oci.oraclecloud.com

# -----------------------------------------------------------------------------
# Phase 2: Oracle Autonomous Database
# -----------------------------------------------------------------------------
# Retrieve passwords from OCI Vault at deploy time:
#   oci secrets secret-bundle get --secret-id <ocid> \
#     --query 'data."secret-bundle-content".content' --raw-output | base64 -d
#
ORACLE_USER=ADMIN
ORACLE_PASSWORD=
ORACLE_CONNECT_STRING=langflowdb_high
ORACLE_WALLET_LOCATION=/wallets/langflow
ORACLE_WALLET_PASSWORD=

# -----------------------------------------------------------------------------
# Phase 3: Better Auth (OIDC with OCI IDCS / Identity Domains)
# -----------------------------------------------------------------------------
# Generate a random secret: openssl rand -base64 32
BETTER_AUTH_SECRET=
BETTER_AUTH_URL=http://localhost:5173

# Encrypt webhook signing secrets at rest (AES-256-GCM, 32-byte key)
# Generate with: openssl rand -base64 32
WEBHOOK_ENCRYPTION_KEY=

# Cookie policy (shared by Better Auth + Fastify)
# BETTER_AUTH_COOKIE_SAMESITE=lax   # lax | strict | none
# BETTER_AUTH_COOKIE_SECURE=true    # force Secure cookies outside production

# OCI IDCS Configuration
# 1. Create a "Confidential Application" in your IDCS domain
# 2. Grant type: Authorization Code
# 3. Redirect URI: {BETTER_AUTH_URL}/api/auth/callback/oci-iam
# 4. Allowed scopes: openid, email, profile, urn:opc:idm:__myscopes__
# 5. Enable PKCE
OCI_IAM_CLIENT_ID=
OCI_IAM_CLIENT_SECRET=
# Replace <GUID> with your IDCS tenant GUID:
OCI_IAM_DISCOVERY_URL=https://idcs-<GUID>.identity.oraclecloud.com/.well-known/openid-configuration

# External IdP hint for federated login.
# Value is the IdP partner name from: oci identity-domains identity-providers list
# When set, the OIDC authorize URL includes ?idp=<name> as a hint to IDCS.
# NOTE: For auto-redirect (bypassing the IDCS login chooser), configure an
# Identity Provider Policy in IDCS that assigns only the SAML IdP to this app.
# OCI_IAM_IDP_NAME=Oracle SSO

# IDCS Group-to-Role Mapping (comma-separated IDCS group names)
# Users in these groups get the corresponding portal role:
#   admin    → full access (all permissions including danger tools + admin)
#   operator → standard access (execute tools, approve, manage workflows)
#   viewer   → read-only access (default for unmatched users)
# OCI_IAM_ADMIN_GROUPS=PortalAdmins,OCI_Administrators
# OCI_IAM_OPERATOR_GROUPS=PortalOperators,OCI_Operators

# IDCS Tenant-to-Org Mapping (format: tenantName:orgId,tenantName2:orgId2)
# Maps IDCS tenant names to portal organizations for auto-provisioning
# OCI_IAM_TENANT_ORG_MAP=mycompany:org-uuid-here

# Default organization for new IDCS users (if no tenant mapping matches)
# OCI_IAM_DEFAULT_ORG_ID=

# -----------------------------------------------------------------------------
# CORS (for /api/v1/* REST API)
# -----------------------------------------------------------------------------
# Comma-separated list of allowed origins for cross-origin browser requests.
# In dev mode, defaults to '*' (allow all). In production, defaults to '' (deny all).
# Set to '*' for a fully public API, or list specific origins:
# ALLOWED_ORIGINS=https://app.example.com,https://dashboard.example.com
# ALLOWED_ORIGINS=*
